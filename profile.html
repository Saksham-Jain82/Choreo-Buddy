<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile | Choreobuddy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap');
        
        :root {
            --bg-deep: #06090f;
            --card-surface: #0f172a;
            --brand-primary: #3b82f6;
        }

        body {
            background-color: var(--bg-deep);
            color: #f8fafc;
            font-family: 'Plus Jakarta Sans', sans-serif;
            overflow-x: hidden;
        }

        .glass-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 24px;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #1e293b;
            border-radius: 10px;
        }

        .profile-gradient {
            background: linear-gradient(180deg, rgba(59, 130, 246, 0.15) 0%, rgba(6, 9, 15, 0) 100%);
        }

        .leader-row {
            transition: 0.2s;
            border-bottom: 1px solid rgba(255, 255, 255, 0.03);
        }

        .leader-row:hover {
            background: rgba(255, 255, 255, 0.02);
            transform: scale(1.01);
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: 0.3s;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: #3b82f6;
        }

        .tab-btn.active {
            background: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            color: white;
        }
    </style>
</head>
<body class="custom-scrollbar">

    <!-- Top Navigation Bar -->
    <nav class="flex items-center justify-between px-8 py-4 border-b border-slate-800/60 sticky top-0 z-50 bg-[#06090f]/80 backdrop-blur-md">
        <div class="flex items-center gap-4">
            <button onclick="window.history.back()" class="back-btn flex items-center gap-2 px-3 py-1.5 rounded-xl text-xs font-bold text-slate-300">
                <span class="material-icons-round text-sm">arrow_back</span>
                DASHBOARD
            </button>
            <div class="h-6 w-px bg-slate-800 ml-2"></div>
            <div class="flex items-center gap-2">
                <div class="bg-blue-600 p-1.5 rounded-lg">
                    <span class="material-icons-round text-white text-sm">auto_fix_high</span>
                </div>
                <!-- Brand Name Updated to Choreobuddy -->
                <span class="font-bold text-lg tracking-tight">Choreo<span class="text-blue-500">buddy</span></span>
            </div>
        </div>
        <div class="flex items-center gap-6">
            <button class="text-slate-400 hover:text-white transition"><span class="material-icons-round">search</span></button>
            <button class="text-slate-400 hover:text-white transition"><span class="material-icons-round">notifications</span></button>
            <div class="h-6 w-px bg-slate-800"></div>
            <!-- Profile avatar or placeholder icon -->
            <button class="w-10 h-10 rounded-full border border-slate-700 bg-slate-800 flex items-center justify-center text-slate-400 hover:border-blue-500 transition">
                <span class="material-icons-round">person</span>
            </button>
        </div>
    </nav>

    <div class="profile-gradient min-h-screen">
        <div class="max-w-7xl mx-auto px-6 py-10 space-y-8">
            
            <!-- User Profile Header -->
            <section class="flex flex-col md:flex-row items-center md:items-end gap-8 px-4">
                <div class="relative group">
                    <img id="profilePhoto" src="https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&q=80&w=200" 
                         class="w-40 h-40 rounded-3xl object-cover border-4 border-blue-500/20 shadow-2xl shadow-blue-500/10">
                    <button onclick="openPhotoEdit()" class="absolute bottom-2 right-2 bg-slate-900 p-2 rounded-xl border border-slate-700 hover:text-blue-400 transition">
                        <span class="material-icons-round text-sm">edit_square</span>
                    </button>
                    <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
                </div>
                
                <div class="flex-1 text-center md:text-left">
                    <div class="flex flex-col md:flex-row md:items-center gap-3 mb-2">
                        <h1 id="profileName" class="text-4xl font-extrabold tracking-tight">Anas Rahman</h1>
                        <button onclick="openNameEdit()" class="text-blue-400 hover:text-blue-300 transition ml-2" title="Edit name">
                            <span class="material-icons-round text-sm">edit</span>
                        </button>
                        <span class="bg-blue-500/10 text-blue-400 text-[10px] font-bold uppercase tracking-widest px-3 py-1 rounded-full border border-blue-500/20 w-fit mx-auto md:mx-0">Senior Disciple</span>
                    </div>
                    <p class="text-slate-400 font-medium mb-6">Learning Bharatanatyam • Kalakshetra Style • Joined Oct 2024</p>
                    
                    <div class="flex flex-wrap justify-center md:justify-start gap-4">
                        <div class="bg-slate-900/50 px-6 py-3 rounded-2xl border border-slate-800/50">
                            <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest mb-1">Total XP</p>
                            <p class="text-xl font-bold">12,450 <span class="text-blue-500">pts</span></p>
                        </div>
                        <div class="bg-slate-900/50 px-6 py-3 rounded-2xl border border-slate-800/50">
                            <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest mb-1">Global Rank</p>
                            <p class="text-xl font-bold">#14 <span class="text-slate-500 text-sm font-medium">/ 2.4k</span></p>
                        </div>
                        <div class="bg-slate-900/50 px-6 py-3 rounded-2xl border border-slate-800/50">
                            <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest mb-1">Skill Level</p>
                            <p class="text-xl font-bold text-emerald-400">Advanced</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Dashboard Content -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- Left Column: Analytics & Stats -->
                <div class="lg:col-span-2 space-y-8">
                    
                    <!-- Performance Chart Card -->
                    <div class="glass-card p-8">
                        <div class="flex items-center justify-between mb-8">
                            <div>
                                <h3 class="text-xl font-bold">Training Analytics</h3>
                                <p id="chartSubtext" class="text-xs text-slate-500 font-bold uppercase tracking-widest mt-1">Accuracy Progress (Last 7 Days)</p>
                            </div>
                            <div class="flex bg-slate-900/80 p-1 rounded-xl border border-slate-800">
                                <button onclick="updateView('week')" id="weekBtn" class="tab-btn px-4 py-1.5 rounded-lg text-xs font-bold active">Week</button>
                                <button onclick="updateView('month')" id="monthBtn" class="tab-btn px-4 py-1.5 rounded-lg text-xs font-bold text-slate-500 hover:text-white transition">Month</button>
                            </div>
                        </div>
                        <div class="h-[300px]">
                            <canvas id="profileProgressChart"></canvas>
                        </div>
                    </div>

                    <!-- Statistics Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="glass-card p-6 border-l-4 border-l-blue-500">
                            <div class="flex items-center gap-3 mb-3 text-slate-400">
                                <span class="material-icons-round">timer</span>
                                <span class="text-[10px] font-bold uppercase tracking-widest">Total Practice</span>
                            </div>
                            <p class="text-3xl font-bold">128.5 <span class="text-sm font-medium text-slate-500">Hrs</span></p>
                        </div>
                        <div class="glass-card p-6 border-l-4 border-l-emerald-500">
                            <div class="flex items-center gap-3 mb-3 text-slate-400">
                                <span class="material-icons-round">check_circle</span>
                                <span class="text-[10px] font-bold uppercase tracking-widest">Postures Verified</span>
                            </div>
                            <p class="text-3xl font-bold">1,240</p>
                        </div>
                        <div class="glass-card p-6 border-l-4 border-l-orange-500">
                            <div class="flex items-center gap-3 mb-3 text-slate-400">
                                <span class="material-icons-round">local_fire_department</span>
                                <span class="text-[10px] font-bold uppercase tracking-widest">Day Streak</span>
                            </div>
                            <p class="text-3xl font-bold">14 <span class="text-sm font-medium text-slate-500">Days</span></p>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Leaderboard & Profile Settings -->
                <div class="space-y-8">
                    
                    <!-- Global Leaderboard Analytics -->
                    <div class="glass-card p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="font-bold">Global Leaderboard</h3>
                            <div class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></div>
                        </div>
                        
                        <div class="space-y-1">
                            <!-- Ranked List -->
                            <div id="leaderboardList">
                                <div class="leader-row flex items-center justify-between p-3 rounded-2xl">
                                    <div class="flex items-center gap-3">
                                        <span class="text-xs font-bold text-yellow-500 w-4">01</span>
                                        <img src="https://i.pravatar.cc/100?u=a1" class="w-8 h-8 rounded-full border border-yellow-500/30">
                                        <p class="text-xs font-bold">Arpana</p>
                                    </div>
                                    <p class="text-xs font-bold text-blue-400">14.8k</p>
                                </div>
                                <div class="leader-row flex items-center justify-between p-3 rounded-2xl">
                                    <div class="flex items-center gap-3">
                                        <span class="text-xs font-bold text-slate-400 w-4">02</span>
                                        <img src="https://i.pravatar.cc/100?u=s1" class="w-8 h-8 rounded-full border border-slate-400/30">
                                        <p class="text-xs font-bold">Saksham</p>
                                    </div>
                                    <p class="text-xs font-bold text-blue-400">13.2k</p>
                                </div>
                                <div class="leader-row flex items-center justify-between p-3 rounded-2xl">
                                    <div class="flex items-center gap-3">
                                        <span class="text-xs font-bold text-slate-500 w-4">03</span>
                                        <img src="https://i.pravatar.cc/100?u=an1" class="w-8 h-8 rounded-full border border-slate-800">
                                        <p class="text-xs font-bold text-slate-300">Ankesh</p>
                                    </div>
                                    <p class="text-xs font-bold text-blue-400">12.9k</p>
                                </div>
                                <div class="leader-row flex items-center justify-between p-3 rounded-2xl">
                                    <div class="flex items-center gap-3">
                                        <span class="text-xs font-bold text-slate-500 w-4">04</span>
                                        <img src="https://i.pravatar.cc/100?u=ad1" class="w-8 h-8 rounded-full border border-slate-800">
                                        <p class="text-xs font-bold text-slate-300">Aadhya</p>
                                    </div>
                                    <p class="text-xs font-bold text-blue-400">12.7k</p>
                                </div>
                                <div class="leader-row flex items-center justify-between p-3 rounded-2xl">
                                    <div class="flex items-center gap-3">
                                        <span class="text-xs font-bold text-slate-500 w-4">05</span>
                                        <img src="https://i.pravatar.cc/100?u=li1" class="w-8 h-8 rounded-full border border-slate-800">
                                        <p class="text-xs font-bold text-slate-300">Lipi</p>
                                    </div>
                                    <p class="text-xs font-bold text-blue-400">12.5k</p>
                                </div>
                            </div>

                            <!-- Current User (You) -->
                            <div class="flex items-center justify-between p-4 my-4 bg-blue-600/10 rounded-2xl border border-blue-500/30 shadow-lg shadow-blue-500/5">
                                <div class="flex items-center gap-3">
                                    <span class="text-xs font-bold text-blue-400 w-4">14</span>
                                    <img src="https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&q=80&w=100" class="w-10 h-10 rounded-full ring-2 ring-blue-500">
                                    <div>
                                        <p class="text-xs font-bold">Anas Rahman</p>
                                        <p class="text-[9px] text-blue-400 font-bold uppercase tracking-tighter">(YOU)</p>
                                    </div>
                                </div>
                                <p class="text-xs font-bold text-white">12.4k</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recommended Focus -->
                    <div class="glass-card p-6">
                        <h3 class="font-bold mb-6">AI Focus Recommendations</h3>
                        <div class="space-y-6">
                            <div>
                                <div class="flex justify-between text-[11px] mb-2 font-bold uppercase tracking-widest text-slate-500">
                                    <span>Araimandi Posture</span>
                                    <span class="text-blue-400">Weak</span>
                                </div>
                                <div class="h-1.5 w-full bg-slate-900 rounded-full overflow-hidden">
                                    <div class="h-full bg-orange-500 rounded-full" style="width: 42%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-[11px] mb-2 font-bold uppercase tracking-widest text-slate-500">
                                    <span>Mudra Clarity</span>
                                    <span class="text-emerald-400">Excellent</span>
                                </div>
                                <div class="h-1.5 w-full bg-slate-900 rounded-full overflow-hidden">
                                    <div class="h-full bg-emerald-500 rounded-full" style="width: 88%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Name Modal -->
    <div id="nameEditModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="glass-card p-8 max-w-sm w-full mx-4">
            <h2 class="text-2xl font-bold mb-6">Edit Name</h2>
            <input type="text" id="nameInput" placeholder="Enter your name" class="w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 text-white placeholder-slate-500 focus:outline-none focus:border-blue-500 mb-6">
            <div class="flex gap-3">
                <button onclick="saveName()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                    Save
                </button>
                <button onclick="closeNameEdit()" class="flex-1 bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Photo Modal -->
    <div id="photoEditModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="glass-card p-8 max-w-sm w-full mx-4">
            <h2 class="text-2xl font-bold mb-6">Change Photo</h2>
            <p class="text-slate-400 mb-6">Upload a new profile photo or enter an image URL</p>
            <input type="text" id="photoUrlInput" placeholder="Paste image URL here" class="w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 text-white placeholder-slate-500 focus:outline-none focus:border-blue-500 mb-4">
            <p class="text-center text-slate-500 text-sm mb-4">OR</p>
            <button onclick="document.getElementById('photoInput').click()" class="w-full bg-slate-800 hover:bg-slate-700 border border-slate-600 text-white font-bold py-3 px-4 rounded-lg transition mb-6">
                <span class="material-icons-round text-sm align-middle">upload_file</span> Upload Photo
            </button>
            <div class="flex gap-3">
                <button onclick="savePhoto()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                    Save
                </button>
                <button onclick="closePhotoEdit()" class="flex-1 bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        let myChart;
        const chartData = {
            week: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                accuracy: [72, 78, 75, 84, 91, 88, 94],
                consistency: [65, 70, 68, 80, 85, 82, 90]
            },
            month: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                accuracy: [68, 75, 82, 91],
                consistency: [60, 72, 78, 88]
            }
        };

        function initChart(type = 'week') {
            const ctx = document.getElementById('profileProgressChart').getContext('2d');
            
            const gradientAcc = ctx.createLinearGradient(0, 0, 0, 400);
            gradientAcc.addColorStop(0, 'rgba(59, 130, 246, 0.4)');
            gradientAcc.addColorStop(1, 'rgba(59, 130, 246, 0)');

            if (myChart) myChart.destroy();

            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: chartData[type].labels,
                    datasets: [
                        {
                            label: 'Accuracy %',
                            data: chartData[type].accuracy,
                            borderColor: '#3b82f6',
                            borderWidth: 3,
                            pointBackgroundColor: '#3b82f6',
                            pointBorderColor: '#0f172a',
                            pointBorderWidth: 2,
                            pointRadius: 5,
                            tension: 0.4,
                            fill: true,
                            backgroundColor: gradientAcc
                        },
                        {
                            label: 'Consistency %',
                            data: chartData[type].consistency,
                            borderColor: 'rgba(16, 185, 129, 0.5)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            tension: 0.4,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            display: true,
                            labels: {
                                color: '#94a3b8',
                                font: { size: 10, family: 'Plus Jakarta Sans', weight: 'bold' },
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: '#0f172a',
                            titleFont: { size: 12 },
                            bodyFont: { size: 12 },
                            cornerRadius: 12,
                            padding: 12,
                            borderWidth: 1,
                            borderColor: 'rgba(255,255,255,0.1)'
                        }
                    },
                    scales: {
                        y: {
                            min: 50,
                            max: 100,
                            grid: { color: 'rgba(255, 255, 255, 0.03)' },
                            ticks: { color: '#64748b', font: { weight: 'bold' } }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#64748b', font: { weight: 'bold' } }
                        }
                    }
                }
            });
        }

        function updateView(type) {
            document.getElementById('weekBtn').classList.remove('active', 'bg-blue-600', 'shadow-lg');
            document.getElementById('monthBtn').classList.remove('active', 'bg-blue-600', 'shadow-lg');
            document.getElementById('weekBtn').classList.add('text-slate-500');
            document.getElementById('monthBtn').classList.add('text-slate-500');

            const activeBtn = document.getElementById(type + 'Btn');
            activeBtn.classList.add('active', 'bg-blue-600', 'shadow-lg');
            activeBtn.classList.remove('text-slate-500');
            activeBtn.classList.add('text-white');

            document.getElementById('chartSubtext').innerText = type === 'week' ? 'Accuracy Progress (Last 7 Days)' : 'Monthly Performance Trend';

            initChart(type);
        }

        window.onload = () => {
            initChart('week');
            loadProfileData();
        };

        // Profile Edit Functions
        function openNameEdit() {
            document.getElementById('nameInput').value = document.getElementById('profileName').innerText;
            document.getElementById('nameEditModal').classList.remove('hidden');
            document.getElementById('nameInput').focus();
        }

        function closeNameEdit() {
            document.getElementById('nameEditModal').classList.add('hidden');
        }

        function saveName() {
            const newName = document.getElementById('nameInput').value.trim();
            if (newName) {
                document.getElementById('profileName').innerText = newName;
                document.querySelector('.leader-row:has(p:contains("Anas Rahman"))') || updateLeaderboardName(newName);
                saveProfileData();
                closeNameEdit();
            } else {
                alert('Please enter a valid name');
            }
        }

        function openPhotoEdit() {
            document.getElementById('photoUrlInput').value = '';
            document.getElementById('photoEditModal').classList.remove('hidden');
        }

        function closePhotoEdit() {
            document.getElementById('photoEditModal').classList.add('hidden');
        }

        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('photoUrlInput').value = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function savePhoto() {
            const photoUrl = document.getElementById('photoUrlInput').value.trim();
            if (photoUrl) {
                document.getElementById('profilePhoto').src = photoUrl;
                document.querySelector('.leader-row:nth-child(5) img').src = photoUrl;
                saveProfileData();
                closePhotoEdit();
            } else {
                alert('Please enter a photo URL or upload a file');
            }
        }

        function saveProfileData() {
            const profileData = {
                name: document.getElementById('profileName').innerText,
                photo: document.getElementById('profilePhoto').src
            };
            localStorage.setItem('profileData', JSON.stringify(profileData));
        }

        function loadProfileData() {
            const saved = localStorage.getItem('profileData');
            if (saved) {
                const data = JSON.parse(saved);
                document.getElementById('profileName').innerText = data.name;
                document.getElementById('profilePhoto').src = data.photo;
            }
        }
    </script>
</body>
</html>